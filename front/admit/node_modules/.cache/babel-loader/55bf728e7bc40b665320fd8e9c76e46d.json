{"remainingRequest":"D:\\xieyu\\2022-5-22\\admit\\node_modules\\_babel-loader@8.2.5@babel-loader\\lib\\index.js!D:\\xieyu\\2022-5-22\\admit\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js??ref--1-0!D:\\xieyu\\2022-5-22\\admit\\node_modules\\_vue-loader@15.9.8@vue-loader\\lib\\index.js??vue-loader-options!D:\\xieyu\\2022-5-22\\admit\\src\\views\\update-password.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\xieyu\\2022-5-22\\admit\\src\\views\\update-password.vue","mtime":1646893522000},{"path":"D:\\xieyu\\2022-5-22\\admit\\babel.config.js","mtime":1646893510000},{"path":"D:\\xieyu\\2022-5-22\\admit\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\xieyu\\2022-5-22\\admit\\node_modules\\_babel-loader@8.2.5@babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\xieyu\\2022-5-22\\admit\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\xieyu\\2022-5-22\\admit\\node_modules\\_vue-loader@15.9.8@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIHJ1bGVGb3JtOiB7fSwKICAgICAgdXNlcjoge30sCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgcGFzc3dvcmQ6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICLlr4bnoIHkuI3og73kuLrnqboiLAogICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgfV0sCiAgICAgICAgbmV3cGFzc3dvcmQ6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICLmlrDlr4bnoIHkuI3og73kuLrnqboiLAogICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgfV0sCiAgICAgICAgcmVwYXNzd29yZDogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuehruiupOWvhueggeS4jeiDveS4uuepuiIsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICB9XQogICAgICB9CiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdGhpcy4kaHR0cCh7CiAgICAgIHVybDogIiIuY29uY2F0KHRoaXMuJHN0b3JhZ2UuZ2V0KCJzZXNzaW9uVGFibGUiKSwgIi9zZXNzaW9uIiksCiAgICAgIG1ldGhvZDogImdldCIKICAgIH0pLnRoZW4oZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgdmFyIGRhdGEgPSBfcmVmLmRhdGE7CgogICAgICBpZiAoZGF0YSAmJiBkYXRhLmNvZGUgPT09IDApIHsKICAgICAgICBfdGhpcy51c2VyID0gZGF0YS5kYXRhOwogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzLiRtZXNzYWdlLmVycm9yKGRhdGEubXNnKTsKICAgICAgfQogICAgfSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBvbkxvZ291dDogZnVuY3Rpb24gb25Mb2dvdXQoKSB7CiAgICAgIHRoaXMuJHN0b3JhZ2UucmVtb3ZlKCJUb2tlbiIpOwogICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7CiAgICAgICAgbmFtZTogImxvZ2luIgogICAgICB9KTsKICAgIH0sCiAgICAvLyDkv67mlLnlr4bnoIEKICAgIG9uVXBkYXRlSGFuZGxlcjogZnVuY3Rpb24gb25VcGRhdGVIYW5kbGVyKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuJHJlZnNbInJ1bGVGb3JtIl0udmFsaWRhdGUoZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICB2YXIgcGFzc3dvcmQgPSAiIjsKCiAgICAgICAgICBpZiAoX3RoaXMyLnVzZXIubWltYSkgewogICAgICAgICAgICBwYXNzd29yZCA9IF90aGlzMi51c2VyLm1pbWE7CiAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzMi51c2VyLnBhc3N3b3JkKSB7CiAgICAgICAgICAgIHBhc3N3b3JkID0gX3RoaXMyLnVzZXIucGFzc3dvcmQ7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKF90aGlzMi5ydWxlRm9ybS5wYXNzd29yZCAhPSBwYXNzd29yZCkgewogICAgICAgICAgICBfdGhpczIuJG1lc3NhZ2UuZXJyb3IoIuWOn+WvhueggemUmeivryIpOwoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChfdGhpczIucnVsZUZvcm0ubmV3cGFzc3dvcmQgIT0gX3RoaXMyLnJ1bGVGb3JtLnJlcGFzc3dvcmQpIHsKICAgICAgICAgICAgX3RoaXMyLiRtZXNzYWdlLmVycm9yKCLkuKTmrKHlr4bnoIHovpPlhaXkuI3kuIDoh7QiKTsKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczIudXNlci5wYXNzd29yZCA9IF90aGlzMi5ydWxlRm9ybS5uZXdwYXNzd29yZDsKICAgICAgICAgIF90aGlzMi51c2VyLm1pbWEgPSBfdGhpczIucnVsZUZvcm0ubmV3cGFzc3dvcmQ7CgogICAgICAgICAgX3RoaXMyLiRodHRwKHsKICAgICAgICAgICAgdXJsOiAiIi5jb25jYXQoX3RoaXMyLiRzdG9yYWdlLmdldCgic2Vzc2lvblRhYmxlIiksICIvdXBkYXRlIiksCiAgICAgICAgICAgIG1ldGhvZDogInBvc3QiLAogICAgICAgICAgICBkYXRhOiBfdGhpczIudXNlcgogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgICAgICAgdmFyIGRhdGEgPSBfcmVmMi5kYXRhOwoKICAgICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5jb2RlID09PSAwKSB7CiAgICAgICAgICAgICAgX3RoaXMyLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICLkv67mlLnlr4bnoIHmiJDlip8s5LiL5qyh55m75b2V57O757uf55Sf5pWIIiwKICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAxNTAwLAogICAgICAgICAgICAgICAgb25DbG9zZTogZnVuY3Rpb24gb25DbG9zZSgpIHt9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX3RoaXMyLiRtZXNzYWdlLmVycm9yKGRhdGEubXNnKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;EACAA,IADA,kBACA;IACA;MACAC,oBADA;MAEAC,YAFA;MAGAC,QAHA;MAIAC;QACAC,WACA;UACAC,cADA;UAEAC,iBAFA;UAGAC;QAHA,CADA,CADA;QAQAC,cACA;UACAH,cADA;UAEAC,kBAFA;UAGAC;QAHA,CADA,CARA;QAeAE,aACA;UACAJ,cADA;UAEAC,mBAFA;UAGAC;QAHA,CADA;MAfA;IAJA;EA4BA,CA9BA;EA+BAG,OA/BA,qBA+BA;IAAA;;IACA;MACAC,6DADA;MAEAC;IAFA,GAGAC,IAHA,CAGA;MAAA;;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA;IACA,CATA;EAUA,CA1CA;EA2CAC;IACAC,QADA,sBACA;MACA;MACA;QAAAC;MAAA;IACA,CAJA;IAKA;IACAC,eANA,6BAMA;MAAA;;MACA;QACA;UACA;;UACA;YACAb;UACA,CAFA,MAEA;YACAA;UACA;;UACA;YACA;;YACA;UACA;;UACA;YACA;;YACA;UACA;;UACA;UACA;;UACA;YACAO,8DADA;YAEAC,cAFA;YAGAb;UAHA,GAIAc,IAJA,CAIA;YAAA;;YACA;cACA;gBACAP,0BADA;gBAEAY,eAFA;gBAGAC,cAHA;gBAIAC,6BACA;cALA;YAOA,CARA,MAQA;cACA;YACA;UACA,CAhBA;QAiBA;MACA,CApCA;IAqCA;EA5CA;AA3CA","names":["data","dialogVisible","ruleForm","user","rules","password","required","message","trigger","newpassword","repassword","mounted","url","method","then","methods","onLogout","name","onUpdateHandler","type","duration","onClose"],"sourceRoot":"src/views","sources":["update-password.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-form\r\n      class=\"detail-form-content\"\r\n      ref=\"ruleForm\"\r\n      :rules=\"rules\"\r\n      :model=\"ruleForm\"\r\n      label-width=\"80px\"\r\n    >\r\n      <el-form-item label=\"原密码\" prop=\"password\">\r\n        <el-input v-model=\"ruleForm.password\" show-password></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"新密码\" prop=\"newpassword\">\r\n        <el-input v-model=\"ruleForm.newpassword\" show-password></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"确认密码\" prop=\"repassword\">\r\n        <el-input v-model=\"ruleForm.repassword\" show-password></el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"onUpdateHandler\">确 定</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      dialogVisible: false,\r\n      ruleForm: {},\r\n      user: {},\r\n      rules: {\r\n        password: [\r\n          {\r\n            required: true,\r\n            message: \"密码不能为空\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        newpassword: [\r\n          {\r\n            required: true,\r\n            message: \"新密码不能为空\",\r\n            trigger: \"blur\"\r\n          }\r\n        ],\r\n        repassword: [\r\n          {\r\n            required: true,\r\n            message: \"确认密码不能为空\",\r\n            trigger: \"blur\"\r\n          }\r\n        ]\r\n      }\r\n    };\r\n  },\r\n  mounted() {\r\n    this.$http({\r\n      url: `${this.$storage.get(\"sessionTable\")}/session`,\r\n      method: \"get\"\r\n    }).then(({ data }) => {\r\n      if (data && data.code === 0) {\r\n        this.user = data.data;\r\n      } else {\r\n        this.$message.error(data.msg);\r\n      }\r\n    });\r\n  },\r\n  methods: {\r\n    onLogout() {\r\n      this.$storage.remove(\"Token\");\r\n      this.$router.replace({ name: \"login\" });\r\n    },\r\n    // 修改密码\r\n    onUpdateHandler() {\r\n      this.$refs[\"ruleForm\"].validate(valid => {\r\n        if (valid) {\r\n          var password = \"\";\r\n          if (this.user.mima) {\r\n            password = this.user.mima;\r\n          } else if (this.user.password) {\r\n            password = this.user.password;\r\n          }\r\n          if (this.ruleForm.password != password) {\r\n            this.$message.error(\"原密码错误\");\r\n            return;\r\n          }\r\n          if (this.ruleForm.newpassword != this.ruleForm.repassword) {\r\n            this.$message.error(\"两次密码输入不一致\");\r\n            return;\r\n          }\r\n          this.user.password = this.ruleForm.newpassword;\r\n          this.user.mima = this.ruleForm.newpassword;\r\n          this.$http({\r\n            url: `${this.$storage.get(\"sessionTable\")}/update`,\r\n            method: \"post\",\r\n            data: this.user\r\n          }).then(({ data }) => {\r\n            if (data && data.code === 0) {\r\n              this.$message({\r\n                message: \"修改密码成功,下次登录系统生效\",\r\n                type: \"success\",\r\n                duration: 1500,\r\n                onClose: () => {\r\n                }\r\n              });\r\n            } else {\r\n              this.$message.error(data.msg);\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n</style>\r\n"]}]}